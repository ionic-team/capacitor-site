{"title":"Security","description":"Security best practices for your Capacitor apps","url":"/docs/guides/security","contributors":["mlynch"],"headings":[{"id":"security-best-practices-for-capacitor","level":1,"text":"Security Best Practices for Capacitor"},{"id":"data-security","level":2,"text":"Data Security"},{"id":"avoid-embedding-secrets-in-code","level":3,"text":"Avoid Embedding Secrets in Code"},{"id":"storing-encryption-keys-session-tokens-etc-","level":3,"text":"Storing Encryption Keys, Session Tokens, etc."},{"id":"authentication-and-deep-linking","level":2,"text":"Authentication and Deep Linking"},{"id":"network-security","level":2,"text":"Network Security"},{"id":"ssl","level":3,"text":"SSL"},{"id":"web-view-security","level":2,"text":"Web View Security"},{"id":"content-security-policy","level":3,"text":"Content Security Policy"},{"id":"javascript-security-techniques","level":3,"text":"JavaScript Security Techniques"}],"srcPath":"./docs/guide/guides/security.md","content":"\n<h1 id=\"security-best-practices-for-capacitor\">\n  \n  Security Best Practices for Capacitor\n  \n</h1>\n<p>Every Capacitor developer is responsible for making sure their app is following security best practices. Without proper care, major security issues can crop up which can prove extremely damaging and expensive.</p>\n<p>Security is a wide topic, but there are a number of areas that Capacitor developers should audit for security compliance, including Data, Authentication/Deep Linking, Network, and Web View security.</p>\n\n<h2 id=\"data-security\">\n  <a class=\"heading-link\" href=\"#data-security\"><ion-icon name=\"link\"></ion-icon>\n  Data Security\n  </a>\n</h2>\n<p>Data Security deals with the security of data stored locally and also in app code.</p>\n\n<h3 id=\"avoid-embedding-secrets-in-code\">\n  <a class=\"heading-link\" href=\"#avoid-embedding-secrets-in-code\"><ion-icon name=\"link\"></ion-icon>\n  Avoid Embedding Secrets in Code\n  </a>\n</h3>\n<p>One of the most important security tips for Capacitor apps, and any frontend app for that matter, is to <em>never embed secrets</em> in your app code. That means make sure your code never contains secret API keys, encryption keys, or any other sensitive data that could be easily stolen using basic app analysis techniques. Watch for environment variable plugins that could be injecting sensitive values into your app code at build time.</p>\n<p>Instead, move most operations requiring secret keys or tokens to the server-side, where they can be protected and any requests can be forwarded from the server. This might be a serverless function or a traditional server-side app process.</p>\n<p>For apps that must work with persisted sensitive keys or tokens on the client, such as an auth token or an encryption key, the recommended options are to only deal with the value in memory (i.e. never persist it to disk), or by using secure keychain/keystore techniques as detailed below.</p>\n\n<h3 id=\"storing-encryption-keys-session-tokens-etc-\">\n  <a class=\"heading-link\" href=\"#storing-encryption-keys-session-tokens-etc-\"><ion-icon name=\"link\"></ion-icon>\n  Storing Encryption Keys, Session Tokens, etc.\n  </a>\n</h3>\n<p>Modern mobile devices and operating systems provide powerful security APIs and dedicated security hardware for storing sensitive values on device. This is how apps provide biometric or secure passcode authentication while managing highly sensitive values such as encryption keys or session tokens.</p>\n<p>The APIs that provide this functionality are available in the <a href=\"https://developer.apple.com/documentation/security/keychain_services\">iOS Keychain Services</a> and <a href=\"https://developer.android.com/training/articles/keystore\">Android Keystore</a> APIs. These APIs are complex and low-level, so you will likely want to find a plugin that uses them for you (such as this <a href=\"https://github.com/ionic-team/cordova-plugin-ios-keychain\">cordova-plugin-ios-keychain</a> community plugin).</p>\n<p>For enterprise use cases, the Capacitor team provides <a href=\"https://ionicframework.com/enterprise/identity-vault\">Identity Vault</a> which provides an easy-to-use API and frequently updated experience on top of these native security APIs. Identity Vault can be used with other Capacitor enterprise products such as <a href=\"https://ionicframework.com/enterprise/offline-storage\">Offline Storage</a> and <a href=\"https://ionicframework.com/enterprise/auth-connect\">Auth Connect</a> to provide the encryption key or authentication token management component of each experience, respectively.</p>\n\n<h2 id=\"authentication-and-deep-linking\">\n  <a class=\"heading-link\" href=\"#authentication-and-deep-linking\"><ion-icon name=\"link\"></ion-icon>\n  Authentication and Deep Linking\n  </a>\n</h2>\n<p>Authentication flows in native apps require extra care, since authentication often happens through the use of Custom URL Schemes. Custom URL Schemes, such as <code>instagram://</code>, are not globally controlled like web domains are, so it&#39;s possible that a malicious app could intercept a request meant for one app by defining and overriding a custom URL scheme. Imagine a secure token being sent to the wrong app!</p>\n<p>Generally, an app should never send sensitive data through a Custom URL scheme deep link (newer techniques such as Universal Links are more secure as they rely on actual web domain ownership, see the <a  href=/docs/guides/deep-links>Deep Links</a>> guide for details).</p>\n<p>This is especially important for oAuth2 flows, where the last step in the authentication experience relies on a deep link back to the app. To mitigate the possibility of a malicious app receiving a token, <a href=\"https://oauth.net/2/pkce/\">PKCE</a> must be used for oAuth2 in Capacitor apps.</p>\n<p>To ensure your oAuth2 flow is secure, make sure your plugin supports PKCE. For enterprise use cases, the official <a href=\"https://ionicframework.com/enterprise/auth-connect\">Auth Connect</a> Capacitor solution fully supports PKCE for oAuth2 authentication flows.</p>\n<p>See this great <a href=\"https://auth0.com/blog/oauth-2-best-practices-for-native-apps/\">oAuth2 Best Practices for Native Apps</a> guide for more info.</p>\n\n<h2 id=\"network-security\">\n  <a class=\"heading-link\" href=\"#network-security\"><ion-icon name=\"link\"></ion-icon>\n  Network Security\n  </a>\n</h2>\n<p>Network security deals with making sure network requests are to trusted endpoints and encrypted to avoid sending sensitive data (such as passwords) in plain text.</p>\n\n<h3 id=\"ssl\">\n  <a class=\"heading-link\" href=\"#ssl\"><ion-icon name=\"link\"></ion-icon>\n  SSL\n  </a>\n</h3>\n<p>Apps should only make requests to SSL-enabled endpoints. This means never make request to endpoints with <code>http://</code>, but rather always use <code>https://</code>. This makes sure data is never sent in plain text.</p>\n<p>However, this by itself isn&#39;t enough. To avoid possible <a href=\"https://en.wikipedia.org/wiki/Man-in-the-middle_attack\">man-in-the-middle</a> attacks, SSL certificates should be pinned so only known certificates are accepted. This must be done natively and on both the client and server. Today, the <a href=\"https://github.com/silkimen/cordova-plugin-advanced-http\">cordova-plugin-advanced-http</a> plugin supports this and there may be other plugins that do as well.</p>\n\n<h2 id=\"web-view-security\">\n  <a class=\"heading-link\" href=\"#web-view-security\"><ion-icon name=\"link\"></ion-icon>\n  Web View Security\n  </a>\n</h2>\n\n<h3 id=\"content-security-policy\">\n  <a class=\"heading-link\" href=\"#content-security-policy\"><ion-icon name=\"link\"></ion-icon>\n  Content Security Policy\n  </a>\n</h3>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\">Content Security Policy (CSP)</a> is a set of security features available in the browser (and, thus, your Capacitor Web View). CSP can be used to limit the resources the user agent is allowed to load in the Web View (such as images, XHR, videos, Web Sockets, etc).</p>\n<p>CSP can be configured in your Capacitor app by adding a <code>meta</code> tag to the <code>&lt;head&gt;</code> with an acceptable CSP format (CSP can be configured both server and client side using the same format). For example, this configuration would allow all requests to the current origin and <code>foo.com</code>:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-html\"><code><meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self' foo.com\"></code></pre>\n  </highlight-code-line>\n  <p>CSP supports a wide variety of configurations, and the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\">CSP reference</a> is a must-read. Another useful resource is <a href=\"https://content-security-policy.com/\">content-security-policy.com</a>.</p>\n\n<h3 id=\"javascript-security-techniques\">\n  <a class=\"heading-link\" href=\"#javascript-security-techniques\"><ion-icon name=\"link\"></ion-icon>\n  JavaScript Security Techniques\n  </a>\n</h3>\n<p>Since the bulk of a Capacitor app is a web app using JavaScript, typical JS security techniques apply.</p>\n<p>JS security is beyond the scope of this document, and there are many existing resources out there for proper JS and web app security techniques. Here&#39;s <a href=\"https://wpengine.com/resources/javascript-security/\">one good one</a> to get you started.</p>\n"}