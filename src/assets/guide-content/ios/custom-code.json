{"title":"Custom Native iOS Code","description":"Custom Native iOS Code","url":"/docs/ios/custom-code","contributors":["dotNetkow","mlynch"],"headings":[{"id":"custom-native-ios-code","level":1,"text":"Custom Native iOS Code"},{"id":"webview-accessible-native-code","level":2,"text":"WebView Accessible Native Code"},{"id":"private-native-code","level":2,"text":"Private Native Code"}],"srcPath":"./docs/guide/ios/custom-code.md","content":"\n<h1 id=\"custom-native-ios-code\">\n  \n  Custom Native iOS Code\n  \n</h1>\n<p class=\"intro\">Many apps will want to add custom Swift (or Objective-C) code to implement native features, without the overhead of building and publishing a proper Capacitor plugin.</p>\n\n<p class=\"intro\">We strongly recommend using Swift to build plugins, as the iOS ecosystem has embraced Swift and you'll be able to find help and developers more easily, but Objective-C works just as well.</p>\n\n<p class=\"intro\">There are two ways to add custom code depending on whether or not you need to access that code from the WebView:</p>\n\n\n\n<h2 id=\"webview-accessible-native-code\">\n  <a class=\"heading-link\" href=\"#webview-accessible-native-code\"><ion-icon name=\"link\"></ion-icon>\n  WebView Accessible Native Code\n  </a>\n</h2>\n<p>The easiest way to build custom native code that needs to be accessible in the WebView is to build\na local Capacitor plugin for it. In this case, building the plugin is as simple as building a new class\nand registering it with Capacitor.</p>\n<p><code>MyPlugin.swift</code></p>\n\n  <highlight-code-line >\n    <pre class=\"language-swift\"><code><span class=\"token keyword\">import</span> <span class=\"token builtin\">Capacitor</span>\n\n@<span class=\"token function\">objc</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">MyPlugin</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyPlugin</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">CAPPlugin</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token atrule\">@objc</span> <span class=\"token keyword\">func</span> <span class=\"token function\">echo</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> call<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CAPPluginCall</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> call<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token string\">\"\"</span>\n    call<span class=\"token punctuation\">.</span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"value\"</span><span class=\"token punctuation\">:</span> value\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n  </highlight-code-line>\n  <p>The <code>@objc</code> decorators are required to make sure Capacitor&#39;s runtime (which must use Obj-C for dynamic plugin support) can see it.</p>\n<p>Next, you&#39;ll need to create a new Objective-C file (with a <code>.m</code> extension, <em>not</em> <code>.h</code>!) corresponding to your plugin (such as <code>MyPlugin.m</code>). Important: you <em>must</em> use the New File dialog in Xcode to do this. You&#39;ll then be prompted by Xcode to create a Bridging Header, which you should do.</p>\n<p>Finally, register the plugin by adding the required Capacitor plugin macros into your new <code>.m</code> file:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-objectivec\"><code><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">import</span> <span class=\"token expression\"><span class=\"token operator\">&lt;</span>Capacitor<span class=\"token operator\">/</span>Capacitor<span class=\"token punctuation\">.</span>h<span class=\"token operator\">></span></span></span>\n\n<span class=\"token function\">CAP_PLUGIN</span><span class=\"token punctuation\">(</span>MyPlugin<span class=\"token punctuation\">,</span> <span class=\"token string\">\"MyPlugin\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">CAP_PLUGIN_METHOD</span><span class=\"token punctuation\">(</span>echo<span class=\"token punctuation\">,</span> CAPPluginReturnPromise<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">)</span></code></pre>\n  </highlight-code-line>\n  <p>This makes <code>MyPlugin</code>, and the <code>echo</code> method available to the Capacitor web runtime like this:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-typescript\"><code><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Plugins <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@capacitor/core\"</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> MyPlugin <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> Plugins\n\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> MyPlugin<span class=\"token punctuation\">.</span><span class=\"token function\">echo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> <span class=\"token string\">\"Hello World!\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span></code></pre>\n  </highlight-code-line>\n  \n<h2 id=\"private-native-code\">\n  <a class=\"heading-link\" href=\"#private-native-code\"><ion-icon name=\"link\"></ion-icon>\n  Private Native Code\n  </a>\n</h2>\n<p>If your code doesn&#39;t need to be accessible from the WebView, then simply add your code anywhere it needs to go. With Capacitor, you have full\ncontrol over your native project.</p>\n<p>Need to add a new event handler in <code>AppDelegate</code>? Just add it! Capacitor won&#39;t touch your code.</p>\n"}