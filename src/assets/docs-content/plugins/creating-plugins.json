{"title":"Creating Capacitor Plugins","description":"Creating Capacitor Plugins","url":"/docs/plugins/creating-plugins","contributors":["mlynch","jcesarmobile"],"lastUpdated":"2020-05-30T21:16:07Z","headings":[{"id":"creating-capacitor-plugins","level":1,"text":"Creating Capacitor Plugins"},{"id":"generate-plugin-scaffolding","level":2,"text":"Generate Plugin Scaffolding"},{"id":"javascript-implementation","level":2,"text":"JavaScript Implementation"},{"id":"ios-plugin","level":2,"text":"iOS Plugin"},{"id":"android-plugin","level":2,"text":"Android Plugin"},{"id":"web-plugin","level":2,"text":"Web Plugin"}],"srcPath":"./docs-md/plugins/creating-plugins.md","content":"\n<h1 id=\"creating-capacitor-plugins\">\n  \n  Creating Capacitor Plugins\n  \n</h1>\n<p>An Capacitor plugin relies on a JavaScript layer that proxies calls to Capacitor&#39;s cross-platform runtime which runs\nthe corresponding native or pure-web code to handle the operation.</p>\n<p>Thus, an Capacitor plugin consists of some JavaScript and then a native implementation for each platform that requires it.</p>\n<p>Let&#39;s implement a simple Todo plugin that stores a list of Todo&#39;s in native device storage or web storage depending on the platform available.</p>\n\n<h2 id=\"generate-plugin-scaffolding\">\n  <a class=\"heading-link\" href=\"#generate-plugin-scaffolding\"><ion-icon name=\"link\"></ion-icon>\n  Generate Plugin Scaffolding\n  </a>\n</h2>\n<p>To generate a new plugin for development, run</p>\n\n  <highlight-code-line >\n    <pre class=\"language-bash\"><code>capacitor plugin:generate com.example.plugin.todo Todo</code></pre>\n  </highlight-code-line>\n  <p>The plugin&#39;s structure will look similar to this:</p>\n\n<h2 id=\"javascript-implementation\">\n  <a class=\"heading-link\" href=\"#javascript-implementation\"><ion-icon name=\"link\"></ion-icon>\n  JavaScript Implementation\n  </a>\n</h2>\n\n<h2 id=\"ios-plugin\">\n  <a class=\"heading-link\" href=\"#ios-plugin\"><ion-icon name=\"link\"></ion-icon>\n  iOS Plugin\n  </a>\n</h2>\n\n  <highlight-code-line >\n    <pre class=\"language-swift\"><code><span class=\"token keyword\">import</span> <span class=\"token builtin\">Capacitor</span>\n\n@<span class=\"token function\">objc</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">Todo</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Todo</span> <span class=\"token punctuation\">:</span> <span class=\"token builtin\">Plugin</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token atrule\">@objc</span> <span class=\"token keyword\">func</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> call<span class=\"token punctuation\">:</span> <span class=\"token builtin\">PluginCall</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Grab the call arguments, guarding to ensure they exist</span>\n    <span class=\"token keyword\">guard</span> <span class=\"token keyword\">let</span> title <span class=\"token operator\">=</span> call<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">self</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      call<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Must provide title\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">guard</span> <span class=\"token keyword\">let</span> text <span class=\"token operator\">=</span> call<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">self</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      call<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Must provide text\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Create the Todo</span>\n    <span class=\"token keyword\">let</span> todo <span class=\"token operator\">=</span> <span class=\"token function\">Todo</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// Save it somewhere</span>\n    <span class=\"token comment\">// ...</span>\n\n    <span class=\"token comment\">// Construct a new PluginResult object with the</span>\n    <span class=\"token comment\">// data we'll send back to the client</span>\n    <span class=\"token keyword\">let</span> result <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"todoId\"</span><span class=\"token punctuation\">:</span> todo<span class=\"token punctuation\">.</span>id\n    <span class=\"token punctuation\">]</span>\n\n    <span class=\"token comment\">// Send the result back to the client</span>\n    call<span class=\"token punctuation\">.</span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token atrule\">@objc</span> <span class=\"token keyword\">public</span> <span class=\"token keyword\">func</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> call<span class=\"token punctuation\">:</span> <span class=\"token builtin\">PluginCall</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ... exercise for the reader</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token atrule\">@objc</span> <span class=\"token keyword\">public</span> <span class=\"token keyword\">func</span> <span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> call<span class=\"token punctuation\">:</span> <span class=\"token builtin\">PluginCall</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ... exercise for the reader</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n  </highlight-code-line>\n  \n<h2 id=\"android-plugin\">\n  <a class=\"heading-link\" href=\"#android-plugin\"><ion-icon name=\"link\"></ion-icon>\n  Android Plugin\n  </a>\n</h2>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>plugin</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>getcapacitor</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">NativePlugin</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>getcapacitor</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Plugin</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>getcapacitor</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">PluginCall</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>getcapacitor</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">PluginMethod</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>getcapacitor</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">JSObject</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@NativePlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Todo</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Plugin</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token annotation punctuation\">@PluginMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PluginCall</span> call<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> title <span class=\"token operator\">=</span> call<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">String</span> text <span class=\"token operator\">=</span> call<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Todo</span> t <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Todo</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// save it somewhere</span>\n\n    <span class=\"token class-name\">JSObject</span> ret <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSONObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      ret<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"todoId\"</span><span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      call<span class=\"token punctuation\">.</span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JSONException</span> ex<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      call<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Unable to send todo\"</span><span class=\"token punctuation\">,</span> ex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre>\n  </highlight-code-line>\n  \n<h2 id=\"web-plugin\">\n  <a class=\"heading-link\" href=\"#web-plugin\"><ion-icon name=\"link\"></ion-icon>\n  Web Plugin\n  </a>\n</h2>\n"}