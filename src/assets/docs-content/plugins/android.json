{"title":"Capacitor Android Plugin Guide","description":"Capacitor Android Plugin Guide","url":"/docs/plugins/android","contributors":["mlynch","jcesarmobile"],"lastUpdated":"2020-05-31T23:03:42Z","headings":[{"id":"capacitor-android-plugin-guide","level":1,"text":"Capacitor Android Plugin Guide"},{"id":"getting-started","level":2,"text":"Getting Started"},{"id":"building-your-plugin","level":2,"text":"Building your Plugin"},{"id":"simple-example","level":3,"text":"Simple Example"},{"id":"accessing-called-data","level":3,"text":"Accessing Called Data"},{"id":"returning-data-back","level":3,"text":"Returning Data Back"},{"id":"presenting-native-screens","level":3,"text":"Presenting Native Screens"},{"id":"intents-without-result-s-","level":4,"text":"Intents without Result(s)"},{"id":"intents-with-result-s-","level":4,"text":"Intents with Result(s)"},{"id":"events","level":3,"text":"Events"},{"id":"app-events","level":4,"text":"App Events"},{"id":"plugin-events","level":4,"text":"Plugin Events"},{"id":"permissions","level":3,"text":"Permissions"},{"id":"override-navigation","level":3,"text":"Override navigation"},{"id":"export-to-capacitor","level":3,"text":"Export to Capacitor"}],"srcPath":"./docs-md/plugins/android.md","content":"\n<h1 id=\"capacitor-android-plugin-guide\">\n  \n  Capacitor Android Plugin Guide\n  \n</h1>\n<p class=\"intro\">Building Capacitor plugins for Android involves writing Java to interface with Android SDKs.</p>\n\n<p class=\"intro\">Capacitor embraces standard Android development tools for building Android plugins. We believe that using Java directly will make it easier to use existing solutions on Stack Overflow, share work with existing native developers, and use platform features as soon as they are made available.</p>\n\n\n<h2 id=\"getting-started\">\n  <a class=\"heading-link\" href=\"#getting-started\"><ion-icon name=\"link\"></ion-icon>\n  Getting Started\n  </a>\n</h2>\n<p>To get started, first generate a plugin as shown in the <a href=\"/docs/plugins/#getting-started\">Getting Started</a> section of the Plugin guide.</p>\n<p>Next, open <code>your-plugin/android/</code> in Android Studio. You then want to navigate to the <code>.java</code> file for your plugin, which changes depending on the Plugin ID and Plugin Class Name you used when creating the plugin.</p>\n<p>For example, for a plugin with the ID <code>com.domain.myplugin</code> and the Plugin Class Name <code>MyPlugin</code>, you would find the <code>.java</code> file at <code>android/src/main/java/com/domain/myplugin/MyPlugin.java</code>.</p>\n\n<h2 id=\"building-your-plugin\">\n  <a class=\"heading-link\" href=\"#building-your-plugin\"><ion-icon name=\"link\"></ion-icon>\n  Building your Plugin\n  </a>\n</h2>\n<p>A Capacitor plugin for Android is a simple Java class that extends <code>com.getcapacitor.Plugin</code> and have a <code>@NativePlugin</code> annotation.\nIt has some methods with <code>@PluginMethod()</code> annotation that will be callable from JavaScript.</p>\n<p>Once your plugin is generated, you can start editing it by opening the file with the Plugin class name you choose on the generator.</p>\n\n<h3 id=\"simple-example\">\n  <a class=\"heading-link\" href=\"#simple-example\"><ion-icon name=\"link\"></ion-icon>\n  Simple Example\n  </a>\n</h3>\n<p>In the generated example, there is a simple echo plugin with an <code>echo</code> function that simply returns a value that it was given.</p>\n<p>This example demonstrates a couple core components of Capacitor plugins: receiving data from a Plugin Call, and returning data back to the caller.</p>\n<p><code>EchoPlugin.java</code></p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token keyword\">package</span> <span class=\"token namespace\">android<span class=\"token punctuation\">.</span>plugin<span class=\"token punctuation\">.</span>test</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>getcapacitor</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">JSObject</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>getcapacitor</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">NativePlugin</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>getcapacitor</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Plugin</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>getcapacitor</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">PluginCall</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>getcapacitor</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">PluginMethod</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@NativePlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">EchoPlugin</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Plugin</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@PluginMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">echo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PluginCall</span> call<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> value <span class=\"token operator\">=</span> call<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">JSObject</span> ret <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        ret<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        call<span class=\"token punctuation\">.</span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n  </highlight-code-line>\n  <blockquote>\n<p>In order to make Capacitor aware of your plugin, you have to <a href=\"#export-to-capacitor\">export it to capacitor</a> in your apps <code>MainActivity</code>.</p>\n</blockquote>\n\n<h3 id=\"accessing-called-data\">\n  <a class=\"heading-link\" href=\"#accessing-called-data\"><ion-icon name=\"link\"></ion-icon>\n  Accessing Called Data\n  </a>\n</h3>\n<p>Each plugin method receives an instance of <code>com.getcapacitor.PluginCall</code> containing all the information of the plugin method invocation from the client.</p>\n<p>A client can send any data that can be JSON serialized, such as numbers, text, booleans, objects, and arrays. This data\nis accessible on the <code>getData</code> field of the call instance, or by using convenience methods such as <code>getString</code> or <code>getObject</code>.</p>\n<p>For example, here is how you&#39;d get data passed to your method:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token annotation punctuation\">@PluginMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">storeContact</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PluginCall</span> call<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token class-name\">String</span> name <span class=\"token operator\">=</span> call<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"yourName\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"default name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token class-name\">JSObject</span> address <span class=\"token operator\">=</span> call<span class=\"token punctuation\">.</span><span class=\"token function\">getObject</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"address\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">boolean</span> isAwesome <span class=\"token operator\">=</span> call<span class=\"token punctuation\">.</span><span class=\"token function\">getBoolean</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"isAwesome\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>call<span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    call<span class=\"token punctuation\">.</span><span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Must provide an id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// ...</span>\n\n  call<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n  </highlight-code-line>\n  <p>Notice the various ways data can be accessed on the <code>PluginCall</code> instance, including how to check for a key using <code>getData</code>&#39;s <code>has</code> method.</p>\n\n<h3 id=\"returning-data-back\">\n  <a class=\"heading-link\" href=\"#returning-data-back\"><ion-icon name=\"link\"></ion-icon>\n  Returning Data Back\n  </a>\n</h3>\n<p>A plugin call can succeed or fail. For calls using promises (most common), succeeding corresponds to calling <code>resolve</code> on the Promise, and failure calling <code>reject</code>. For those using callbacks, a succeeding will call the success callback or the error callback if failing.</p>\n<p>The <code>resolve</code> method of <code>PluginCall</code> takes a <code>JSObject</code> and supports JSON-serializable data types. Here&#39;s an example of returning data back to the client:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token class-name\">JSObject</span> ret <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nret<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"added\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">JSObject</span> info <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninfo<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"unique-id-1234\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nret<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"info\"</span><span class=\"token punctuation\">,</span> info<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncall<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n  </highlight-code-line>\n  <p>To fail, or reject a call, use <code>call.reject</code>, passing an error string and (optionally) an <code>Exception</code> instance</p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code>call<span class=\"token punctuation\">.</span><span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>exception<span class=\"token punctuation\">.</span><span class=\"token function\">getLocalizedMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> exception<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n  </highlight-code-line>\n  \n<h3 id=\"presenting-native-screens\">\n  <a class=\"heading-link\" href=\"#presenting-native-screens\"><ion-icon name=\"link\"></ion-icon>\n  Presenting Native Screens\n  </a>\n</h3>\n<p>To present a Native Screen over the Capacitor screen we will use <a href=\"https://developer.android.com/guide/components/intents-filters\">Android&#39;s Intents</a>. Intents allow you to start an activity from your app, or from another app. <a href=\"https://developer.android.com/guide/components/intents-common\">See Common Intents</a></p>\n\n<h4 id=\"intents-without-result-s-\">\n  <a class=\"heading-link\" href=\"#intents-without-result-s-\"><ion-icon name=\"link\"></ion-icon>\n  Intents without Result(s)\n  </a>\n</h4>\n<p>Most times you just want to present the native Activity,\nin this case you can just trigger the <a href=\"https://developer.android.com/guide/components/intents-common\">relevant action</a>.</p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token class-name\">Intent</span> intent <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Intent</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Intent</span><span class=\"token punctuation\">.</span>ACTION_VIEW<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">getActivity</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">startActivity</span><span class=\"token punctuation\">(</span>intent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n  </highlight-code-line>\n  \n<h4 id=\"intents-with-result-s-\">\n  <a class=\"heading-link\" href=\"#intents-with-result-s-\"><ion-icon name=\"link\"></ion-icon>\n  Intents with Result(s)\n  </a>\n</h4>\n<p>Sometimes when you launch an Intent, you expect some result back. In that case you want to use <code>startActivityForResult</code>.</p>\n<p>Also make sure you call <code>saveCall(call);</code> as you will need it later when handling the intents result.</p>\n<p>You also have to register your intents <a href=\"https://developer.android.com/training/basics/intents/result#StartActivity\">unique request</a> code with <code>@NativePlugin</code> in order for\n<code>handleOnActivityResult</code> to be triggered.</p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token annotation punctuation\">@NativePlugin</span><span class=\"token punctuation\">(</span>\n  requestCodes<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token class-name\">MyPlugin</span><span class=\"token punctuation\">.</span>REQUEST_IMAGE_PICK<span class=\"token punctuation\">}</span> <span class=\"token comment\">// register request code(s) for intent results</span>\n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ImagePicker</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Plugin</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> REQUEST_IMAGE_PICK <span class=\"token operator\">=</span> <span class=\"token number\">12345</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Unique request code</span>\n\n  <span class=\"token annotation punctuation\">@PluginMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">pickImage</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PluginCall</span> call<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">saveCall</span><span class=\"token punctuation\">(</span>call<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Intent</span> intent <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Intent</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Intent</span><span class=\"token punctuation\">.</span>ACTION_PICK<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    intent<span class=\"token punctuation\">.</span><span class=\"token function\">setType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"image/*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">startActivityForResult</span><span class=\"token punctuation\">(</span>call<span class=\"token punctuation\">,</span> intent<span class=\"token punctuation\">,</span> REQUEST_IMAGE_PICK<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// in order to handle the intents result, you have to @Override handleOnActivityResult</span>\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handleOnActivityResult</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> requestCode<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> resultCode<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Intent</span> data<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleOnActivityResult</span><span class=\"token punctuation\">(</span>requestCode<span class=\"token punctuation\">,</span> resultCode<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> <span class=\"token class-name\">Get</span> the previously saved call\n    <span class=\"token class-name\">PluginCall</span> savedCall <span class=\"token operator\">=</span> <span class=\"token function\">getSavedCall</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>savedCall <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>requestCode <span class=\"token operator\">==</span> REQUEST_IMAGE_PICK<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">/</span> <span class=\"token class-name\">Do</span> something <span class=\"token keyword\">with</span> the data\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n  </highlight-code-line>\n  \n<h3 id=\"events\">\n  <a class=\"heading-link\" href=\"#events\"><ion-icon name=\"link\"></ion-icon>\n  Events\n  </a>\n</h3>\n<p>Capacitor Plugins can emit App events and Plugin events</p>\n\n<h4 id=\"app-events\">\n  <a class=\"heading-link\" href=\"#app-events\"><ion-icon name=\"link\"></ion-icon>\n  App Events\n  </a>\n</h4>\n<p>App Events are regular javascript events, like <code>window</code> or <code>document</code> events.</p>\n<p>Capacitor provides all this functions to fire events:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token comment\">//If you want to provide the target</span>\nbridge<span class=\"token punctuation\">.</span><span class=\"token function\">triggerJSEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myCustomEvent\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"window\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nbridge<span class=\"token punctuation\">.</span><span class=\"token function\">triggerJSEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myCustomEvent\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"document\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"{ 'dataKey': 'dataValue' }\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Window Events</span>\nbridge<span class=\"token punctuation\">.</span><span class=\"token function\">triggerWindowJSEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myCustomEvent\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nbridge<span class=\"token punctuation\">.</span><span class=\"token function\">triggerWindowJSEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myCustomEvent\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"{ 'dataKey': 'dataValue' }\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Document events</span>\nbridge<span class=\"token punctuation\">.</span><span class=\"token function\">triggerDocumentJSEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myCustomEvent\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nbridge<span class=\"token punctuation\">.</span><span class=\"token function\">triggerDocumentJSEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myCustomEvent\"</span><span class=\"token punctuation\">,</span>  <span class=\"token string\">\"{ 'dataKey': 'dataValue' }\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n  </highlight-code-line>\n  <p>And to listen for it, just use regular javascript:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-typescript\"><code>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myCustomEvent\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myCustomEvent was fired\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n  </highlight-code-line>\n  \n<h4 id=\"plugin-events\">\n  <a class=\"heading-link\" href=\"#plugin-events\"><ion-icon name=\"link\"></ion-icon>\n  Plugin Events\n  </a>\n</h4>\n<p>Plugins can emit their own events that you can listen by attaching a listener to the plugin Object like this:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-typescript\"><code>Plugins<span class=\"token punctuation\">.</span>MyPlugin<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myPluginEvent\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">info<span class=\"token punctuation\">:</span> <span class=\"token builtin\">any</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myPluginEvent was fired\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n  </highlight-code-line>\n  <p>To emit the event from the Java plugin class you can do it like this:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token class-name\">JSObject</span> ret <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nret<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"some value\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">notifyListeners</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myPluginEvent\"</span><span class=\"token punctuation\">,</span> ret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n  </highlight-code-line>\n  <p>To remove a listener from the plugin object:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-typescript\"><code><span class=\"token keyword\">const</span> myPluginEventListener <span class=\"token operator\">=</span> Plugins<span class=\"token punctuation\">.</span>MyPlugin<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myPluginEvent\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">info<span class=\"token punctuation\">:</span> <span class=\"token builtin\">any</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myPluginEvent was fired\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmyPluginEventListener<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n  </highlight-code-line>\n  \n<h3 id=\"permissions\">\n  <a class=\"heading-link\" href=\"#permissions\"><ion-icon name=\"link\"></ion-icon>\n  Permissions\n  </a>\n</h3>\n<p>Some Plugins will require you to request permissions.\nCapacitor provides some helpers to do that.</p>\n<p>First declare your plugin permissions in the <code>@NativePlugin</code> annotation</p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token annotation punctuation\">@NativePlugin</span><span class=\"token punctuation\">(</span>\n  permissions<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">Manifest</span><span class=\"token punctuation\">.</span>permission<span class=\"token punctuation\">.</span>ACCESS_NETWORK_STATE\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span></code></pre>\n  </highlight-code-line>\n  <p>You can check if all the required permissions has been granted with <code>hasRequiredPermissions()</code>.\nYou can request all permissions with <code>pluginRequestAllPermissions();</code>.\nYou can request for a single permission with <code>pluginRequestPermission(Manifest.permission.CAMERA, 12345);</code>\nOr you can request a group of permissions with:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> REQUEST_IMAGE_CAPTURE <span class=\"token operator\">=</span> <span class=\"token number\">12345</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">pluginRequestPermissions</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token class-name\">Manifest</span><span class=\"token punctuation\">.</span>permission<span class=\"token punctuation\">.</span>CAMERA<span class=\"token punctuation\">,</span>\n  <span class=\"token class-name\">Manifest</span><span class=\"token punctuation\">.</span>permission<span class=\"token punctuation\">.</span>WRITE_EXTERNAL_STORAGE<span class=\"token punctuation\">,</span>\n  <span class=\"token class-name\">Manifest</span><span class=\"token punctuation\">.</span>permission<span class=\"token punctuation\">.</span>READ_EXTERNAL_STORAGE\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> REQUEST_IMAGE_CAPTURE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n  </highlight-code-line>\n  <p>To handle the permission request you have to Override <code>handleRequestPermissionsResult</code></p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token annotation punctuation\">@Override</span>\n<span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handleRequestPermissionsResult</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> requestCode<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> permissions<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> grantResults<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleRequestPermissionsResult</span><span class=\"token punctuation\">(</span>requestCode<span class=\"token punctuation\">,</span> permissions<span class=\"token punctuation\">,</span> grantResults<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"handling request perms result\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token class-name\">PluginCall</span> savedCall <span class=\"token operator\">=</span> <span class=\"token function\">getSavedCall</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>savedCall <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No stored plugin call for permissions request result\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> result <span class=\"token operator\">:</span> grantResults<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result <span class=\"token operator\">==</span> <span class=\"token class-name\">PackageManager</span><span class=\"token punctuation\">.</span>PERMISSION_DENIED<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      savedCall<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"User denied permission\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>requestCode <span class=\"token operator\">==</span> REQUEST_IMAGE_CAPTURE<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// We got the permission</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n  </highlight-code-line>\n  \n<h3 id=\"override-navigation\">\n  <a class=\"heading-link\" href=\"#override-navigation\"><ion-icon name=\"link\"></ion-icon>\n  Override navigation\n  </a>\n</h3>\n<p>Capacitor plugins can override the webview navigation. For that the plugin can override <code>public Boolean shouldOverrideLoad(Uri url)</code> method.\nReturning <code>true</code> causes the WebView to abort loading the URL.\nReturning <code>false</code> causes the WebView to continue loading the URL.\nReturning <code>null</code> will defer to the default Capacitor policy.</p>\n\n<h3 id=\"export-to-capacitor\">\n  <a class=\"heading-link\" href=\"#export-to-capacitor\"><ion-icon name=\"link\"></ion-icon>\n  Export to Capacitor\n  </a>\n</h3>\n<p>By using the <code>@NativePlugin</code> and <code>@PluginMethod()</code> annotations in your plugins, you make them available to Capacitor, but you still need an extra step in your application to make Capacitor aware of the plugins.</p>\n<p>This is done in your apps <code>MainActivity</code>, where you <code>add</code> it in e.g. <code>src/main/java/com/example/myapp/MainActivity.java</code> like so:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-java\"><code><span class=\"token comment\">// Other imports...</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>myapp</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">EchoPlugin</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MainActivity</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BridgeActivity</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Bundle</span> savedInstanceState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span>savedInstanceState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Initializes the Bridge</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span>savedInstanceState<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Class</span><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Plugin</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Additional plugins you've installed go here</span>\n      <span class=\"token comment\">// Ex: add(TotallyAwesomePlugin.class);</span>\n      <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EchoPlugin</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n  </highlight-code-line>\n  "}