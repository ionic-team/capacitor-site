{"title":"Updating Your Capacitor Android Project","description":"Updating Your Capacitor Android Project","url":"/docs/android/updating","contributors":["mlynch","jcesarmobile","rdlabo","dotNetkow"],"lastUpdated":"2020-07-08T20:22:08Z","headings":[{"id":"updating-your-capacitor-android-project","level":1,"text":"Updating Your Capacitor Android Project"},{"id":"updating-capacitor-android-library","level":2,"text":"Updating Capacitor Android Library"},{"id":"updating-android-project","level":2,"text":"Updating Android Project"},{"id":"from-1-0-0-to-1-1-0","level":3,"text":"From 1.0.0 to 1.1.0"},{"id":"from-1-3-0-to-1-4-0","level":3,"text":"From &lt;= 1.3.0 to 1.4.0"},{"id":"from-1-5-1-to-2-0-0","level":3,"text":"From &lt;= 1.5.1 to 2.0.0"}],"srcPath":"./docs-md/android/updating.md","content":"\n<h1 id=\"updating-your-capacitor-android-project\">\n  \n  Updating Your Capacitor Android Project\n  \n</h1>\n<p class=\"intro\">Occasionally, you'll need to make Capacitor updates to your Android app, including updating the version of Capacitor used in your app, or using new ways of interfacing with Capacitor inside of your Android codebase.</p>\n\n\n<h2 id=\"updating-capacitor-android-library\">\n  <a class=\"heading-link\" href=\"#updating-capacitor-android-library\"><ion-icon name=\"link\"></ion-icon>\n  Updating Capacitor Android Library\n  </a>\n</h2>\n<p>To update the version of @capacitor/android used in your app, just npm install latest version:</p>\n\n  <highlight-code-line >\n    <pre class=\"language-bash\"><code><span class=\"token function\">npm</span> <span class=\"token function\">install</span> @capacitor/android@latest</code></pre>\n  </highlight-code-line>\n  <p>Then from Android Studio click the &quot;Sync Project with Gradle Files&quot; button.</p>\n\n<h2 id=\"updating-android-project\">\n  <a class=\"heading-link\" href=\"#updating-android-project\"><ion-icon name=\"link\"></ion-icon>\n  Updating Android Project\n  </a>\n</h2>\n<p>To update the base structure of your Android project, view the <a href=\"https://github.com/ionic-team/capacitor/tree/master/android-template\">android-template</a> project in the Capacitor repo, under the tag corresponding to the latest stable release of Capacitor. The core project is kept simple on purpose: it shouldn&#39;t take much time to see what is different from the core project and your project.</p>\n\n<h3 id=\"from-1-0-0-to-1-1-0\">\n  <a class=\"heading-link\" href=\"#from-1-0-0-to-1-1-0\"><ion-icon name=\"link\"></ion-icon>\n  From 1.0.0 to 1.1.0\n  </a>\n</h3>\n<p>Recommended change:</p>\n<ul>\n<li>Update <code>.gitignore</code> file inside <code>android</code> folder with <a href=\"https://github.com/ionic-team/capacitor/commit/e27586780baed231c09f2737bb94a9338aab5a03#diff-15c65f143d85c95277307da1bdd0528e\">this changes</a></li>\n</ul>\n\n<h3 id=\"from-1-3-0-to-1-4-0\">\n  <a class=\"heading-link\" href=\"#from-1-3-0-to-1-4-0\"><ion-icon name=\"link\"></ion-icon>\n  From &lt;= 1.3.0 to 1.4.0\n  </a>\n</h3>\n<p>Recommended change:</p>\n<ul>\n<li>Update <code>strings.xml</code> file inside <code>android/app/src/main/res/values/</code> folder with <a href=\"https://github.com/ionic-team/capacitor/commit/ed6647b35a8da08d26a7ff13cc9f4fd918b923a0#diff-15c65f143d85c95277307da1bdd0528e\">this change</a></li>\n</ul>\n\n<h3 id=\"from-1-5-1-to-2-0-0\">\n  <a class=\"heading-link\" href=\"#from-1-5-1-to-2-0-0\"><ion-icon name=\"link\"></ion-icon>\n  From &lt;= 1.5.1 to 2.0.0\n  </a>\n</h3>\n<p>Mandatory change:</p>\n<ul>\n<li><p>Use Android X</p>\n<p>Capacitor 2.0 uses Android X for Android support library dependencies as recommended by Google, so the native project needs to be updated to use Android X too.</p>\n<p>From Android Studio do <code>Refactor -&gt; Migrate to AndroidX</code>. Then click on <code>Migrate</code> button and finally click on <code>Do Refactor</code>.</p>\n<p>If using Cordova or Capacitor plugins that don&#39;t use Android X yet, you can use <a href=\"https://www.npmjs.com/package/jetifier\">jetifier</a> tool to patch them.</p>\n</li>\n</ul>\n\n  <highlight-code-line >\n    <pre class=\"language-bash\"><code><span class=\"token function\">npm</span> <span class=\"token function\">install</span> jetifier\nnpx jetifier</code></pre>\n  </highlight-code-line>\n  <p>  To run it automatically after every package install, add <code>&quot;postinstall&quot;: &quot;jetifier&quot;</code> in the <code>package.json</code>.</p>\n<p>Recommended changes:</p>\n<ul>\n<li><p>Create common variables</p>\n<p>Create a <code>android/variables.gradle</code> file with this content</p>\n<pre><code>ext {\n  minSdkVersion = 21\n  compileSdkVersion = 29\n  targetSdkVersion = 29\n  androidxAppCompatVersion = '1.1.0'\n  androidxCoreVersion =  '1.2.0'\n  androidxMaterialVersion =  '1.1.0-rc02'\n  androidxBrowserVersion =  '1.2.0'\n  androidxLocalbroadcastmanagerVersion =  '1.0.0'\n  firebaseMessagingVersion =  '20.1.2'\n  playServicesLocationVersion =  '17.0.0'\n  junitVersion =  '4.12'\n  androidxJunitVersion =  '1.1.1'\n  androidxEspressoCoreVersion =  '3.2.0'\n  cordovaAndroidVersion =  '7.0.0'\n}</code></pre><p>In <code>android/build.gradle</code> file, add <code>apply from: &quot;variables.gradle&quot;</code> as shown <a href=\"https://github.com/ionic-team/capacitor/blob/master/android-template/build.gradle#L18\">here</a>.</p>\n</li>\n<li><p>Use common variables</p>\n<p>If you created the <code>variables.gradle</code> file, update your project to use them. In the <code>android/app/build.gradle</code> file, change:</p>\n<ul>\n<li><code>compileSdkVersion 28</code> to <code>compileSdkVersion rootProject.ext.compileSdkVersion</code></li>\n<li><code>minSdkVersion 21</code> to <code>minSdkVersion rootProject.ext.minSdkVersion</code></li>\n<li><code>targetSdkVersion 28</code> to <code>targetSdkVersion rootProject.ext.targetSdkVersion</code></li>\n<li><code>implementation &#39;androidx.appcompat:appcompat:1.0.0&#39;</code> to <code>implementation &quot;androidx.appcompat:appcompat:$androidxAppCompatVersion&quot;</code></li>\n<li><code>testImplementation &#39;junit:junit:4.12&#39;</code> to <code>testImplementation &quot;junit:junit:$junitVersion&quot;</code></li>\n<li><code>androidTestImplementation &#39;androidx.test.ext:junit:1.1.1&#39;</code> to <code>androidTestImplementation &quot;androidx.test.ext:junit:$androidxJunitVersion&quot;</code></li>\n<li><code>androidTestImplementation &#39;androidx.test.espresso:espresso-core:3.1.0&#39;</code> to <code>androidTestImplementation &quot;androidx.test.espresso:espresso-core:$androidxEspressoCoreVersion&quot;</code></li>\n</ul>\n<p>Note that they use double quote instead of single quote now, that&#39;s required for variables to work.</p>\n</li>\n<li><p>Android Studio Plugin Update Recommended</p>\n<p>When you open the Android project in Android Studio, a <code>Plugin Update Recommended</code> message will appear. Click on <code>update</code>. It will tell you to update Gradle plugin and Gradle. Click <code>Update</code> button.</p>\n<p>You can also manually update the Gradle plugin and Gradle.</p>\n<p>To manually update Gradle plugin, edit <code>android/build.gradle</code> file. Change <code>classpath &#39;com.android.tools.build:gradle:3.3.2&#39;</code> to <code>classpath &#39;com.android.tools.build:gradle:3.6.1&#39;</code>.</p>\n<p>To manually update Gradle, edit <code>android/gradle/wrapper/gradle-wrapper.properties</code>. Change <code>gradle-4.10.1-all.zip</code> to <code>gradle-5.6.4-all.zip</code>.</p>\n</li>\n<li><p>Update Google Services plugin</p>\n<p>In <code>android/build.gradle</code> file, change <code>classpath &#39;com.google.gms:google-services:4.2.0&#39;</code> to <code>classpath &#39;com.google.gms:google-services:4.3.3&#39;</code>.</p>\n</li>\n<li><p>Change configChanges to avoid app restarts</p>\n<p>In <code>android/app/src/main/AndroidManifest.xml</code> file, add <code>|smallestScreenSize|screenLayout|uiMode</code> in the activity <code>android:configChanges</code> attribute.</p>\n</li>\n<li><p>Add caches folder to FileProvider file paths to avoid permission error on editing gallery images.</p>\n<p>In <code>android/app/src/main/res/xml/file_paths.xml</code> add <code>&lt;cache-path name=&quot;my_cache_images&quot; path=&quot;.&quot; /&gt;</code>.</p>\n</li>\n</ul>\n<p>For API changes, check the <a href=\"https://github.com/ionic-team/capacitor/releases/tag/2.0.0\">Release Notes</a>.</p>\n"}